import{_ as oe,r as a,u as le,w as re,m as ie,o as c,e as m,f as e,F as N,n as ee,t as _,h as G,k as ke,p as f,q as de,s as ce,x as Ce,b as Pe,d as De,y as Z,l as C,g as w,v as P,z as $,A as Ue}from"./index-b1a8d95c.js";import{u as Fe}from"./exerciseStore-e54aa4a3.js";const Le={props:{planId:Number},setup(u){const t=a([]),h=a(null),s=a(""),E=a(!1),k=a(""),n=le().userIdGetter,p=a(""),D=a(""),U=a(""),F=async()=>{try{const d=await f.get(`http://228k123.e2.mars-hosting.com/exercises/getExercises?planId=${u.planId}`),v=Object.keys(d.data)[0],g=d.data[v],y=new Map;g.forEach(b=>{const I=b.days_name;y.has(I)||y.set(I,[]),y.get(I).push({...b,exerciseId:b.exercises_id})}),t.value=Array.from(y).map(([b,I])=>({dayName:b,exercises:I}))}catch(d){console.error("Error fetching exercises:",d)}},S=async d=>{var v;try{const g=await f.get(`http://228k123.e2.mars-hosting.com/exercises/getExerciseDetails?exerciseId=${d}`),y=(v=g.data.Description[0])==null?void 0:v.exercises_description;y?s.value=y:console.error("No exercise details found in the API response:",g.data)}catch(g){console.error("Error fetching exercise details:",g)}},R=async()=>{try{const d=await f.get(`http://228k123.e2.mars-hosting.com/exercises/getExerciseImage?exerciseId=${h.value.exerciseId}`,{responseType:"arraybuffer"}),v=new Blob([d.data],{type:"image/jpeg"}),g=URL.createObjectURL(v);k.value=g,E.value=!0}catch(d){console.error("Error fetching exercise image:",d)}},L=async()=>{try{const v=(await f.get(`http://228k123.e2.mars-hosting.com/exercises/trainingType?userId=${n}`)).data.trainingType;if(v&&v.length>0){const g=v[0];p.value=g.training_type_sets||"",D.value=g.training_type_reps||"",U.value=g.training_type_rest_time||""}else console.warn("Training type array is empty")}catch(d){console.error("Error fetching training type:",d)}},B=async d=>{h.value=d,S(d.exerciseId),E.value=!1,await L()},V=()=>{h.value=null,s.value="",E.value=!1,k.value=""};return re(()=>u.planId,()=>{u.planId&&F()}),ie(()=>{u.planId&&F()}),{sets:p,reps:D,restTime:U,exerciseDays:t,selectedExercise:h,selectedExerciseDetails:s,showImage:E,exerciseImageUrl:k,showModal:B,closeModal:V,showExerciseImage:R,getTrainingType:L}}},ue=u=>(de("data-v-28765795"),u=u(),ce(),u),Me={class:"container"},Te={class:"cube"},Ge=ue(()=>e("h3",null,"Exercises for the Selected Plan",-1)),Ne={class:"days-grid"},Se=["onClick"],Re={key:0},Be={key:1},Ve=ue(()=>e("p",null,"Training type information not available",-1)),Ae=[Ve],We={key:2,class:"image-container"},Oe=["src"];function je(u,t,h,s,E,k){return c(),m(N,null,[e("div",Me,[e("div",Te,[Ge,e("div",Ne,[(c(!0),m(N,null,ee(s.exerciseDays,(i,n)=>(c(),m("div",{key:n,class:"day"},[e("h4",null,"Day "+_(n+1),1),e("ul",null,[(c(!0),m(N,null,ee(i.exercises,p=>(c(),m("li",{key:p.exerciseId},[e("span",{onClick:D=>s.showModal(p),class:"exercise-link"},_(p.exercises_name),9,Se)]))),128))])]))),128))])])]),s.selectedExercise?(c(),m("div",{key:0,class:"modal",onClick:t[3]||(t[3]=(...i)=>s.closeModal&&s.closeModal(...i))},[e("div",{class:"modal-content",onClick:t[2]||(t[2]=ke(()=>{},["stop"]))},[e("span",{class:"close",onClick:t[0]||(t[0]=(...i)=>s.closeModal&&s.closeModal(...i))},"Ã—"),e("h2",null,_(s.selectedExercise.exercises_name),1),s.selectedExercise&&s.sets!==void 0&&s.reps!==void 0&&s.restTime!==void 0?(c(),m("div",Re,[e("p",null,"Sets: "+_(s.sets)+" | Reps: "+_(s.reps)+" | Rest time: "+_(s.restTime),1)])):(c(),m("div",Be,Ae)),e("p",null,_(s.selectedExerciseDetails),1),e("button",{onClick:t[1]||(t[1]=(...i)=>s.showExerciseImage&&s.showExerciseImage(...i))},"Show Exercise Image"),s.showImage?(c(),m("div",We,[e("img",{src:s.exerciseImageUrl,alt:"Exercise Image"},null,8,Oe)])):G("",!0)])])):G("",!0)],64)}const He=oe(Le,[["render",je],["__scopeId","data-v-28765795"]]),ze="/assets/trash-de0650ac.png";const ae=Fe(),qe={name:"MyWorkout",components:{ExerciseListComponent:He},setup(){const u=a("personalDetails"),t=a({exerciseList:[]}),h=le(),s=Ce(),E=a(""),k=a(""),i=a({}),n=a(!1),p=a(!1),D=a(""),U=a(""),F=a(""),S=a(""),R=a(""),L=a(""),B=a(""),V=a(""),d=a(""),v=a(!1),g=a(""),y=a(""),b=a(""),I=a(""),W=a(""),O=a(""),j=a(""),H=a(""),z=a(""),_e=a(!1),q=a(null);a(null);const M=a(""),Y=a(""),A=a(null),J=a(!1),me=Pe(),se=r=>{u.value=r,r==="myPlans"?K():r==="personalDetails"&&(p.value=!1,X())},K=async()=>{const r=h.userIdGetter;try{const l=await f.get(`${ae.API_URL}getPlan`,{params:{userId:r}});t.value=l.data}catch(l){console.error("Error fetching plans:",l)}},X=async()=>{const r=h.userIdGetter;try{const l=await f.get(`${s.API_URL}user/userDetails?userId=${r}`);D.value=l.data.user[0].users_first_name,U.value=l.data.user[0].users_last_name,F.value=l.data.user[0].users_email,S.value=l.data.user[0].users_date_of_birth,R.value=l.data.user[0].body_measurement_gender,L.value=l.data.user[0].body_measurement_height,B.value=l.data.user[0].body_measurement_weight,V.value=l.data.user[0].body_measurement_fitness_level,d.value=l.data.user[0].fitness_goal_id,i.value=l.data.user[0],_e.value=!0}catch(l){console.error("Error fetching user details:",l)}},te=async()=>{const r=h.pictureIdGetter;try{const l=Date.now(),x=await f.get(`http://228k123.e2.mars-hosting.com/user/getUserImage?pictureId=${r}&timestamp=${l}`,{responseType:"arraybuffer"}),T=new Blob([x.data],{type:"image/jpeg"}),Q=URL.createObjectURL(T);k.value=Q}catch(l){console.error("Error fetching user image:",l)}},ge=(r,l)=>{E.value=r,p.value=!0},he=async r=>{if(window.confirm("Are you sure you want to delete this plan?"))try{const x=await f.delete(`${ae.API_URL}deletePlan?planId=${r}`);alert("Plan deleted successfully:"),K()}catch(x){alert("Error deleting plan:",x)}},ve=()=>{n.value=!0},pe=()=>{n.value=!1},ye=()=>{g.value=D.value,y.value=U.value,b.value=F.value,I.value=S.value,W.value=R.value,O.value=L.value,j.value=B.value,H.value=V.value,z.value=d.value,v.value=!0},fe=r=>{const l=r.target.files[0];q.value=l},we=async()=>{const r=h.userIdGetter,l=h.bodyIdGetter;h.pictureIdGetter;const x={userId:r,users_first_name:g.value,users_last_name:y.value,users_email:b.value,users_date_of_birth:I.value,fitness_goal_goal:z.value},T={bodyId:l,body_measurement_gender:W.value,body_measurement_height:O.value,body_measurement_weight:j.value,body_measurement_fitness_level:H.value};try{if(q.value){const ne=new FormData;ne.append("picture",q.value);const Hs=await f.put(`http://228k123.e2.mars-hosting.com/user/updatePicture?pictureId=${h.pictureIdGetter}`,ne,{headers:{"Content-Type":"multipart/form-data"}})}const Q=await f.put(`http://228k123.e2.mars-hosting.com/user/updateUserInformation?userId=${r}&name=${x.users_first_name}&lastName=${x.users_last_name}&email=${x.users_email}&fitness_goal=${x.fitness_goal_goal}&date_of_birth=${x.users_date_of_birth}`),js=await f.put(`http://228k123.e2.mars-hosting.com/user/updateBodyMeasurment?bodyId=${l}&gender=${T.body_measurement_gender}&height=${T.body_measurement_height}&weight=${T.body_measurement_weight}&fitness_level=${T.body_measurement_fitness_level}`);i.users_first_name=g.value,i.users_last_name=y.value,i.users_email=b.value,i.users_date_of_birth=I.value,i.body_measurement_gender=W.value,i.body_measurement_height=O.value,i.body_measurement_weight=j.value,i.body_measurement_fitness_level=H.value,i.fitness_goal_goal=z.value,v.value=!1,X(),te(),alert("Changes saved successfully!")}catch(Q){alert("Error saving changes:",Q)}},be=()=>{v.value=!1},Ie=()=>{J.value=!0,M.value="",Y.value="",A.value=null},xe=()=>{J.value=!1},Ee=async()=>{if(M.value===Y.value){const r=h.userIdGetter;try{await f.put(`http://228k123.e2.mars-hosting.com/user/changePassword?userId=${r}&password=${M.value}`),console.log("New password is: ",M.value),M.value="",Y.value="",A.value=null,J.value=!1,alert("Password changed successfully!")}catch(l){A.value="Error changing password. Please try again.",console.error("Error changing password:",l)}}else A.value="Passwords do not match."};return ie(async()=>{if(h.isAuthenticatedGetter)se("myPlans");else{alert("You must be logged in to access this section"),me.push("/login");return}K()}),re(()=>u.value,r=>{r==="personalDetails"?(X(),te()):r==="myPlans"&&K()}),{firstName:D,lastName:U,email:F,dob:S,gender:R,height:L,weight:B,fitnessLevel:V,fitnessGoal:d,currentTab:u,plans:t,switchTab:se,selectedPlan:E,selectPlan:ge,deletePlan:he,userImageURL:k,handleFileUpload:fe,userDetails:i,openUserDetailsForm:ve,closeUserDetailsForm:pe,showUserDetailsForm:n,editMode:v,enterEditMode:ye,saveChanges:we,cancelEdit:be,editedFirstName:g,editedLastName:y,editedEmail:b,editedDateOfBirth:I,editedGender:W,editedHeight:O,editedWeight:j,editedFitnessLevel:H,editedFitnessGoal:z,showExerciseListComponent:p,openChangePasswordForm:Ie,showChangePasswordForm:J,newPassword:M,confirmPassword:Y,passwordChangeError:A,confirmPasswordChange:Ee,cancelPasswordChange:xe,selectedImage:q}}},o=u=>(de("data-v-45e9039b"),u=u(),ce(),u),Ye={class:"page-container"},Je={class:"left-menu"},Ke={class:"content-container"},Qe={key:0,class:"content"},Xe=o(()=>e("h2",null,"Personal Details",-1)),Ze={class:"user-details-container"},$e={class:"user-image"},es=["src"],ss=o(()=>e("strong",null,"Name:",-1)),ts=o(()=>e("strong",null,"Email:",-1)),ns=o(()=>e("strong",null,"Date of Birth:",-1)),as=o(()=>e("strong",null,"Gender:",-1)),os=o(()=>e("strong",null,"Height:",-1)),ls=o(()=>e("strong",null,"Weight:",-1)),rs=o(()=>e("strong",null,"Fitness Level:",-1)),is=o(()=>e("strong",null,"Fitness Goal:",-1)),ds={key:0},cs=o(()=>e("strong",null,"New Password:",-1)),us=o(()=>e("strong",null,"Confirm Password:",-1)),_s={key:0,class:"error-message"},ms=o(()=>e("strong",null,"Profile Image:",-1)),gs=o(()=>e("strong",null,"First Name:",-1)),hs=o(()=>e("strong",null,"Last Name:",-1)),vs=o(()=>e("strong",null,"Email:",-1)),ps=o(()=>e("strong",null,"Date of Birth:",-1)),ys=o(()=>e("strong",null,"Gender:",-1)),fs=o(()=>e("option",{value:"Male"},"Male",-1)),ws=o(()=>e("option",{value:"Female"},"Female",-1)),bs=[fs,ws],Is=o(()=>e("strong",null,"Height:",-1)),xs=o(()=>e("strong",null,"Weight:",-1)),Es=o(()=>e("strong",null,"Fitness Level:",-1)),ks=o(()=>e("option",{value:"Beginner"},"Beginner",-1)),Cs=o(()=>e("option",{value:"Intermediate"},"Intermediate",-1)),Ps=o(()=>e("option",{value:"Advanced"},"Advanced",-1)),Ds=[ks,Cs,Ps],Us=o(()=>e("strong",null,"Fitness Goal:",-1)),Fs=o(()=>e("option",{value:"1"},"Strength",-1)),Ls=o(()=>e("option",{value:"2"},"Build Muscle",-1)),Ms=o(()=>e("option",{value:"3"},"Endurance",-1)),Ts=o(()=>e("option",{value:"4"},"Lose Fat",-1)),Gs=[Fs,Ls,Ms,Ts],Ns={key:1,class:"content"},Ss=o(()=>e("h2",null,"My Plans",-1)),Rs={class:"plan-button-container"},Bs=["onClick"],Vs=["onClick"],As=o(()=>e("img",{id:"trash",src:ze,alt:"Delete Icon"},null,-1)),Ws=[As];function Os(u,t,h,s,E,k){const i=De("ExerciseListComponent");return c(),m("div",Ye,[e("div",Je,[e("button",{onClick:t[0]||(t[0]=n=>s.switchTab("myPlans")),class:Z({active:s.currentTab==="myPlans"})}," My Plans ",2),e("button",{onClick:t[1]||(t[1]=n=>s.switchTab("personalDetails")),class:Z({active:s.currentTab==="personalDetails"})}," Personal Details ",2)]),e("div",Ke,[s.currentTab==="personalDetails"?(c(),m("div",Qe,[Xe,e("div",Ze,[e("div",$e,[e("img",{src:s.userImageURL,alt:"User Image"},null,8,es)]),s.editMode?(c(),m(N,{key:1},[e("label",null,[ms,e("input",{type:"file",onChange:t[8]||(t[8]=(...n)=>s.handleFileUpload&&s.handleFileUpload(...n)),accept:"image/*"},null,32)]),e("label",null,[gs,w(e("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>s.editedFirstName=n)},null,512),[[P,s.editedFirstName]])]),e("label",null,[hs,w(e("input",{"onUpdate:modelValue":t[10]||(t[10]=n=>s.editedLastName=n)},null,512),[[P,s.editedLastName]])]),e("label",null,[vs,w(e("input",{"onUpdate:modelValue":t[11]||(t[11]=n=>s.editedEmail=n)},null,512),[[P,s.editedEmail]])]),e("label",null,[ps,w(e("input",{"onUpdate:modelValue":t[12]||(t[12]=n=>s.editedDateOfBirth=n)},null,512),[[P,s.editedDateOfBirth]])]),e("label",null,[ys,w(e("select",{"onUpdate:modelValue":t[13]||(t[13]=n=>s.editedGender=n)},bs,512),[[$,s.editedGender]])]),e("label",null,[Is,w(e("input",{type:"text","onUpdate:modelValue":t[14]||(t[14]=n=>s.editedHeight=n)},null,512),[[P,s.editedHeight]])]),e("label",null,[xs,w(e("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=n=>s.editedWeight=n)},null,512),[[P,s.editedWeight]])]),e("label",null,[Es,w(e("select",{"onUpdate:modelValue":t[16]||(t[16]=n=>s.editedFitnessLevel=n)},Ds,512),[[$,s.editedFitnessLevel]])]),e("label",null,[Us,w(e("select",{"onUpdate:modelValue":t[17]||(t[17]=n=>s.editedFitnessGoal=n)},Gs,512),[[$,s.editedFitnessGoal]])]),e("button",{onClick:t[18]||(t[18]=(...n)=>s.saveChanges&&s.saveChanges(...n))},"Save"),e("button",{onClick:t[19]||(t[19]=(...n)=>s.cancelEdit&&s.cancelEdit(...n))},"Cancel")],64)):(c(),m(N,{key:0},[e("p",null,[ss,C(" "+_(s.userDetails.users_first_name)+" "+_(s.userDetails.users_last_name),1)]),e("p",null,[ts,C(" "+_(s.userDetails.users_email),1)]),e("p",null,[ns,C(" "+_(s.userDetails.users_date_of_birth),1)]),e("p",null,[as,C(" "+_(s.userDetails.body_measurement_gender),1)]),e("p",null,[os,C(" "+_(s.userDetails.body_measurement_height)+" cm ",1)]),e("p",null,[ls,C(" "+_(s.userDetails.body_measurement_weight)+" kg ",1)]),e("p",null,[rs,C(" "+_(s.userDetails.body_measurement_fitness_level),1)]),e("p",null,[is,C(" "+_(s.userDetails.fitness_goal_goal),1)]),e("button",{onClick:t[2]||(t[2]=(...n)=>s.enterEditMode&&s.enterEditMode(...n))},"Edit"),e("button",{onClick:t[3]||(t[3]=(...n)=>s.openChangePasswordForm&&s.openChangePasswordForm(...n))},"Change Password"),s.showChangePasswordForm?(c(),m("div",ds,[e("label",null,[cs,w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>s.newPassword=n),type:"password"},null,512),[[P,s.newPassword]])]),e("label",null,[us,w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>s.confirmPassword=n),type:"password"},null,512),[[P,s.confirmPassword]])]),s.passwordChangeError?(c(),m("p",_s,_(s.passwordChangeError),1)):G("",!0),e("button",{onClick:t[6]||(t[6]=(...n)=>s.confirmPasswordChange&&s.confirmPasswordChange(...n))},"Confirm"),e("button",{onClick:t[7]||(t[7]=(...n)=>s.cancelPasswordChange&&s.cancelPasswordChange(...n))},"Cancel")])):G("",!0)],64))])])):s.currentTab==="myPlans"?(c(),m("div",Ns,[Ss,(c(!0),m(N,null,ee(s.plans.exerciseList,n=>(c(),m("div",{key:n.plan_id,class:"plan-item"},[e("div",Rs,[e("button",{onClick:p=>s.selectPlan(n.plan_id,n.plan_name),class:Z({active:s.selectedPlan===n.plan_id,clickable:!0})},_(n.plan_name),11,Bs),e("button",{onClick:p=>s.deletePlan(n.plan_id),class:"delete-button"},Ws,8,Vs)])]))),128))])):G("",!0),s.showExerciseListComponent?(c(),Ue(i,{key:2,planId:s.selectedPlan},null,8,["planId"])):G("",!0)])])}const Ys=oe(qe,[["render",Os],["__scopeId","data-v-45e9039b"]]);export{Ys as default};
