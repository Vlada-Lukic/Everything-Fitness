{"POST":"let userId = param('userId', null);\r\nlet planName = param('planName', null);\r\n\r\n\r\nlet workoutPlanParam = {\r\n  user_id: userId,\r\n  plan_name: planName,\r\n  \r\n}\r\n\r\nlet insertWorkoutPlanSql = `INSERT INTO workout_plan (user_id, plan_name) VALUES (:user_id, :plan_name)`;\r\nlet insertWorkoutPlanQuery = db.query(insertWorkoutPlanSql, workoutPlanParam);\r\nlet planId = insertWorkoutPlanQuery[0].id;\r\n\r\n\r\nlet planIdParam = {\r\n  plan_id: planId,\r\n}\r\n\r\n\r\n\r\n\r\n\r\nlet insertDay1Sql = `INSERT INTO plan_exercise (plan_id, exercise_id)\r\nSELECT :plan_id, exercises_id\r\nFROM (\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Legs')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Chest')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Back')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Biceps')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Isolation')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Core')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n) AS selected_exercises_day1;`;\r\n\r\n\r\nlet insertPushQuery = db.query(insertDay1Sql, planIdParam);\r\nlet planExerciseId1 = insertPushQuery[0].id;\r\nwrite(\"day1\", planExerciseId1);\r\nlet day1 = db.query(\"INSERT INTO workout_details (day_id, plan_exercise_id) SELECT 1, plan_exercise_id FROM plan_exercise WHERE plan_id = ? and plan_exercise_id >= ?\", planId, planExerciseId1);\r\nwrite(\"workout_details1\", day1);\r\n\r\n// ====== END DAY 1========\r\n\r\nlet insertDay2Sql = `INSERT INTO plan_exercise (plan_id, exercise_id)\r\nSELECT :plan_id, exercises_id\r\nFROM (\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Back')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Shoulders')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Legs')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Triceps')\r\n      AND resistance_id = (SELECT resistance_id FROM resistance WHERE resistance_name = 'Push')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Isolation')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n    UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Core')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n) AS selected_exercises_day2;`;\r\n\r\nlet insertPullQuery = db.query(insertDay2Sql, planIdParam);\r\nlet planExerciseId2 = insertPullQuery[0].id;\r\nwrite(\"day2\", planExerciseId2);\r\n\r\nlet day2 = db.query(\"INSERT INTO workout_details (day_id, plan_exercise_id) SELECT 2, plan_exercise_id FROM plan_exercise WHERE plan_id = ? and plan_exercise_id >= ?\", planId, planExerciseId2);\r\nwrite(\"workout_details2\", day2);\r\n\r\n// ====== END DAY 2========\r\n\r\n\r\nlet insertDay3Sql = `INSERT INTO plan_exercise (plan_id, exercise_id)\r\nSELECT :plan_id, exercises_id\r\nFROM (\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Legs')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Back')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n    UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Chest')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Compound')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Legs')\r\n      AND movement_id = (SELECT movement_id FROM movement WHERE movement_name = 'Isolation')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n  UNION\r\n  (\r\n    SELECT exercises_id\r\n    FROM exercises\r\n    WHERE muscle_id = (SELECT muscle_groups_id FROM muscle_groups WHERE muscle_groups_name = 'Core')\r\n    ORDER BY RAND()\r\n    LIMIT 1\r\n  )\r\n) AS selected_exercises_day3;`;\r\n\r\nlet insertLegsQuery = db.query(insertDay3Sql, planIdParam);\r\nlet planExerciseId3 = insertLegsQuery[0].id;\r\nwrite(\"day3\", planExerciseId3);\r\n\r\nlet day3 = db.query(\"INSERT INTO workout_details (day_id, plan_exercise_id) SELECT 3, plan_exercise_id FROM plan_exercise WHERE plan_id = ? and plan_exercise_id >= ?\", planId, planExerciseId3);\r\nwrite(\"workout_details3\", day3);\r\n\r\n// ====== END DAY 3========\r\n\r\n\r\n\r\n\r\nwrite(\"message\", \"Workout generated successfully!\");\r\n","META":{"language":"JavaScript"}}