{"POST":"let exerciseName = param('exercisesName', null);\r\nlet exerciseDescription = param('exercisesDescription', null);\r\nlet resistanceId = param('resistance', null);\r\nlet movementId = param('movement', null);\r\nlet muscleId = param('muscle', null);\r\nlet File = param('exercisePicture', null);\r\nlet selectedSubMuscleGroups = param('selectedSubMuscles', []);\r\n\r\nif (\r\n  exerciseName === null || exerciseDescription === null || muscleId === null\r\n) {\r\n  write('message', 'Missing parameter');\r\n  exit();\r\n}\r\n\r\nif (resistanceId === '') {\r\n  resistanceId = null;\r\n}\r\n\r\nif (movementId === '') {\r\n  movementId = null;\r\n}\r\n\r\n// Insert picture into exercise_picture table\r\nlet exercisePictureParam = {\r\n  exercisePicture: File\r\n}\r\n\r\nlet insertExercisePictureSql = `INSERT INTO exercise_picture (exercise_picture_name) VALUES (:exercisePicture)`\r\nlet insertExercisePictureQuery = db.query(insertExercisePictureSql, exercisePictureParam);\r\nlet exercisePictureId = insertExercisePictureQuery[0].id;\r\n\r\n// Insert data into the 'exercises' table\r\nlet exerciseParam = {\r\n  exercises_name: exerciseName,\r\n  exercises_description: exerciseDescription,\r\n  resistance_id: resistanceId,\r\n  movement_id: movementId,\r\n  muscle_id: muscleId,\r\n  exercise_picture_id: exercisePictureId,\r\n}\r\n\r\nlet insertExerciseSql = `\r\n  INSERT INTO exercises (exercises_name, exercises_description, resistance_id, movement_id, muscle_id, exercise_picture_id)\r\n  VALUES (:exercises_name, :exercises_description, :resistance_id, :movement_id, :muscle_id, :exercise_picture_id)\r\n`\r\n\r\nlet insertExerciseQuery = db.query(insertExerciseSql, exerciseParam);\r\nlet exerciseId = insertExerciseQuery[0].id;\r\n\r\n// Insert data into the 'exercise_sub_muscle' table for selected sub muscle groups\r\n let insertExerciseSubMuscleSql = `\r\n    INSERT INTO exercise_sub_muscle (exercise_id, sub_muscle_id)\r\n    VALUES (:exercise_id, :sub_muscle_id)\r\n  `;\r\nlet exerciseSubMuscleParam = [];\r\n  if (Array.isArray(selectedSubMuscleGroups) && selectedSubMuscleGroups.length > 0) {\r\n    for(let subMuscleId of selectedSubMuscleGroups) {\r\n       exerciseSubMuscleParam = {\r\n        exercise_id: exerciseId,\r\n        sub_muscle_id: subMuscleId,\r\n       \r\n      };\r\n      db.query(insertExerciseSubMuscleSql, exerciseSubMuscleParam);\r\n  }\r\n}\r\n\r\n\r\nwrite('sub_muscle_id', selectedSubMuscleGroups);\r\nwrite('message', 'Exercise Added');\r\n\r\n","META":{"language":"JavaScript"}}